(function(){'use strict';// Simple template systemconst templates = {'/': function(){ return `<section aria-labelledby="home-title"><h2 id="home-title">Nossa Missão</h2><p>Promover ações sustentáveis e conscientização ambiental para um futuro mais verde.</p><div class="row"><div class="col-6 project-card"><h3>Refloresta Já</h3><p>Plantio de espécies nativas.</p></div><div class="col-6 project-card"><h3>Educa Verde</h3><p>Oficinas em escolas e comunidades.</p></div></div></section>`},'/projetos': function(){ return `<section aria-labelledby="proj-title"><h2 id="proj-title">Projetos</h2><article class="project-card" tabindex="0"><h3>Refloresta Já</h3><p>Mais de 10.000 árvores plantadas.</p></article><article class="project-card" tabindex="0"><h3>Educa Verde</h3><p>Programas educativos para escolas.</p></article></section>`},'/cadastro': function(){ return `<section aria-labelledby="cad-title"><h2 id="cad-title">Cadastre-se</h2><form id="formCadastro" novalidate><label for="nome">Nome</label><input id="nome" name="nome" required minlength="3"><label for="email">E-mail</label><input id="email" name="email" type="email" required><button class="button" type="submit">Enviar</button></form></section>`}};function navigateTo(path){history.pushState({},'',path);render(path);}function render(path){const main = document.getElementById('main');const tpl = templates[path] || templates['/'];main.innerHTML = tpl();main.focus();// enhance formsconst form = document.getElementById('formCadastro');if(form){form.addEventListener('submit', function(e){e.preventDefault();showToast('Cadastro enviado (simulação)');});}}// Link handlerdocument.addEventListener('click', function(e){const a = e.target.closest('[data-link]');if(a){e.preventDefault();const path = a.getAttribute('data-link');navigateTo(path);}});// Handle back/forwardwindow.addEventListener('popstate', ()=> render(location.pathname) );// initial renderrender(location.pathname || '/');// accessibility: keyboard nav for menu and submenuconst nav = document.getElementById('main-nav');const btnToggleNav = document.getElementById('btnToggleNav');if(btnToggleNav){btnToggleNav.addEventListener('click', function(){const expanded = this.getAttribute('aria-expanded') === 'true';this.setAttribute('aria-expanded', String(!expanded));nav.classList.toggle('open');});}// submenu keyboard interactionsdocument.querySelectorAll('.has-submenu > a').forEach(link=>{link.addEventListener('keydown', function(e){if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); const expanded = this.getAttribute('aria-expanded') === 'true'; this.setAttribute('aria-expanded', String(!expanded)); }if(e.key === 'ArrowDown'){ e.preventDefault(); const submenu = this.parentNode.querySelector('.submenu a'); if(submenu) submenu.focus(); }});});// Theme & contrast toggles (persist in localStorage)const themeToggle = document.getElementById('themeToggle');const contrastToggle = document.getElementById('contrastToggle');function applyPrefs(){const high = localStorage.getItem('highContrast') === 'true';if(high) document.documentElement.classList.add('high-contrast'); else document.documentElement.classList.remove('high-contrast');const dark = localStorage.getItem('darkMode') === 'true';document.body.classList.toggle('theme-dark', dark);themeToggle && themeToggle.setAttribute('aria-pressed', String(dark));contrastToggle && contrastToggle.setAttribute('aria-pressed', String(high));}if(themeToggle){themeToggle.addEventListener('click', ()=>{ const cur = localStorage.getItem('darkMode')==='true'; localStorage.setItem('darkMode', String(!cur)); applyPrefs(); });}if(contrastToggle){contrastToggle.addEventListener('click', ()=>{ const cur = localStorage.getItem('highContrast')==='true'; localStorage.setItem('highContrast', String(!cur)); applyPrefs(); });}applyPrefs();// Toastsfunction showToast(msg, timeout=4000){let toast = document.querySelector('.toast');if(!toast){ toast = document.createElement('div'); toast.className='toast'; document.body.appendChild(toast); }toast.textContent = msg; toast.classList.add('show');setTimeout(()=> toast.classList.remove('show'), timeout);}// Simple modal (accessible)window.openModal = function(title, body){const modal = document.createElement('div');modal.className='modal';modal.setAttribute('role','dialog');modal.setAttribute('aria-modal','true');modal.innerHTML = `<div class="project-card"><h2>${title}</h2><div>${body}</div><button id="closeModal" class="button">Fechar</button></div>`;document.body.appendChild(modal);document.getElementById('closeModal').focus();document.getElementById('closeModal').addEventListener('click', ()=>{ modal.remove(); });};// basic a11y: trap focus in modal if created (lightweight) — omitted for brevity})();
